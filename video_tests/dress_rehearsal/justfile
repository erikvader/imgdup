# Will do exactly the same thing as the real deal, but with fewer video files.
# Expected results:
# - The ignored frame(s) should show up in the graveyard.
# - One dup should appear.
# - Only one collision per frame, not two, where two mirrored frames match each other.
# - Two identical videos shall have many collisions

import '../lib.just'

default:
    @just --list --justfile '{{justfile()}}'

# Removes all generated files
reset:
    rm -vrf videodup.db videodup.db.backup _DUPS_ _GRAVEYARD_ list.txt

mkdirs:
    mkdir -p _GRAVEYARD_ _DUPS_

run: reset videodup debug

videodup: mkdirs
    {{rootjust}} run release videodup

debug:
    {{rootjust}} run release videodup-debug --all --root . --entry-dir _DUPS_

# Manual debugging and testing

list:
    {{rootjust}} run release videodup-edit --database-file videodup.db stats list:list.txt

randel:
    {{rootjust}} run release videodup-edit --database-file videodup.db randel:2
